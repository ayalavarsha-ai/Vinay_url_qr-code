<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dynamic Page</title>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js"></script>
</head>
<body>
  <h1>Welcome to RapidX Data Portal!</h1>
  <p>This is hosted alongside my Flutter app on GitHub Pages.</p>
  <h2 id="title">Loading...</h2>
  <p id="content"></p>

  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCZurl9JjIHhn7okxnMNQ5et9dmmMwOBMI",
      authDomain: "rapidx-18a16.firebaseapp.com",
      projectId: "rapidx-18a16",
      storageBucket: "rapidx-18a16.appspot.com",
      messagingSenderId: "47383229563",
      appId: "1:47383229563:web:b014d3a477aa40659c9ede",
      measurementId: "G-23LKWV6NT1"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Get Document ID from URL
    const params = new URLSearchParams(window.location.search);
    const docId = params.get('id'); // Example URL: ?id=abc123
    console.log("Document ID from URL:", docId);

    // Fetch Data from Firestore
    async function fetchData() {
      if (docId) {
        try {
          // Use "Patient Data" as the collection name
          const docRef = db.collection("Patient Data").doc(docId);
          const docSnap = await docRef.get();

          if (docSnap.exists) {
            const data = docSnap.data();
            console.log("Document Data:", data); // Log document data
            document.getElementById("title").textContent = data.title || "Untitled";
            document.getElementById("content").textContent = data.content || "No content available.";
          } else {
            console.log("Document does not exist");
            document.getElementById("title").textContent = "404 Not Found";
            document.getElementById("content").textContent = "The requested document does not exist.";
          }
        } catch (error) {
          console.error("Error fetching document:", error);
          document.getElementById("title").textContent = "Error";
          document.getElementById("content").textContent = "Failed to load the data.";
        }
      } else {
        console.error("No Document ID in URL");
        document.getElementById("title").textContent = "Invalid URL";
        document.getElementById("content").textContent = "No document ID found in the URL.";
      }
    }

    fetchData();
  </script>
</body>
</html>
